Stephen's solution certainly isn't optimal. Fancy giving me a basic rundown on the problem here and I'll see if I can devise a more elegant one?